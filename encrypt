work on encryption.
first work will be made heer, then moved to plugin
This branch chall not be merged to master, until functionality will not be moved to plugin
